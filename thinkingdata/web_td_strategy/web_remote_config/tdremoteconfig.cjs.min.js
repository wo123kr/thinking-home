function asyncGeneratorStep(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function _asyncToGenerator(s){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=s.apply(e,o);function a(e){asyncGeneratorStep(r,t,n,a,i,"next",e)}function i(e){asyncGeneratorStep(r,t,n,a,i,"throw",e)}a(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _regenerator(){var g,e="function"==typeof Symbol?Symbol:{},t=e.iterator||"@@iterator",n=e.toStringTag||"@@toStringTag";function r(e,t,n,r){var a,i,o,s,c,l,u,f,h,t=t&&t.prototype instanceof p?t:p,t=Object.create(t.prototype);return _regeneratorDefine(t,"_invoke",(a=e,i=n,u=r||[],f=!1,h={p:l=0,n:0,v:g,a:d,f:d.bind(g,4),d:function(e,t){return o=e,s=0,c=g,h.n=t,m}},function(e,t,n){if(1<l)throw TypeError("Generator is already running");for(f&&1===t&&d(t,n),s=t,c=n;(_=s<2?g:c)||!f;){o||(s?s<3?(1<s&&(h.n=-1),d(s,c)):h.n=c:h.v=c);try{if(l=2,o){if(_=o[e=s?e:"next"]){if(!(_=_.call(o,c)))throw TypeError("iterator result is not an object");if(!_.done)return _;c=_.value,s<2&&(s=0)}else 1===s&&(_=o.return)&&_.call(o),s<2&&(c=TypeError("The iterator does not provide a '"+e+"' method"),s=1);o=g}else if((_=(f=h.n<0)?c:a.call(i,h))!==m)break}catch(e){o=g,s=1,c=e}finally{l=1}}return{value:_,done:f}}),!0),t;function d(e,t){for(s=e,c=t,_=0;!f&&l&&!n&&_<u.length;_++){var n,r=u[_],a=h.p,i=r[2];3<e?(n=i===t)&&(c=r[(s=r[4])?5:s=3],r[4]=r[5]=g):r[0]<=a&&((n=e<2&&a<r[1])?(s=0,h.v=t,h.n=r[1]):a<i&&(n=e<3||r[0]>t||i<t)&&(r[4]=e,r[5]=t,h.n=i,s=0))}if(n||1<e)return m;throw f=!0,t}}var m={};function p(){}function a(){}function i(){}var _=Object.getPrototypeOf,e=[][t]?_(_([][t]())):(_regeneratorDefine(_={},t,function(){return this}),_),o=i.prototype=p.prototype=Object.create(e);function s(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,_regeneratorDefine(e,n,"GeneratorFunction")),e.prototype=Object.create(o),e}return _regeneratorDefine(o,"constructor",a.prototype=i),_regeneratorDefine(i,"constructor",a),_regeneratorDefine(i,n,a.displayName="GeneratorFunction"),_regeneratorDefine(o),_regeneratorDefine(o,n,"Generator"),_regeneratorDefine(o,t,function(){return this}),_regeneratorDefine(o,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:r,m:s}})()}function _regeneratorDefine(e,t,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(_regeneratorDefine=function(e,t,n,r){function a(t,n){_regeneratorDefine(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))})(e,t,n,r)}function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==typeof e?e:e+""}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}for(var Config={LIB_VERSION:"1.1.1",TEMPLATE_DEFAULT:"default",USER_ID_EXPIRED_TIME:2592e3,CONFIG_EXPIRED_TIME:43200,ACTIVATION_STRATEGY_IMMEDIATELY:"immediately",ACTIVATION_STRATEGY_NEXT:"next",DATE_TYPE:"datetime",NETWORK_TIMEOUT:-10002,SIGN_ILLEGAL:-10004},chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var encode=function(e){for(var t=new Uint8Array(e),n=t.length,r="",a=0;a<n;a+=3)r=(r=(r=(r+=chars[t[a]>>2])+chars[(3&t[a])<<4|t[a+1]>>4])+chars[(15&t[a+1])<<2|t[a+2]>>6])+chars[63&t[a+2]];return n%3==2?r=r.substring(0,r.length-1)+"=":n%3==1&&(r=r.substring(0,r.length-2)+"=="),r},decode=function(e){for(var t,n,r,a,i=.75*e.length,o=e.length,s=0,i=("="===e[e.length-1]&&(i--,"="===e[e.length-2])&&i--,new ArrayBuffer(i)),c=new Uint8Array(i),l=0;l<o;l+=4)t=lookup[e.charCodeAt(l)],n=lookup[e.charCodeAt(l+1)],r=lookup[e.charCodeAt(l+2)],a=lookup[e.charCodeAt(l+3)],c[s++]=t<<2|n>>4,c[s++]=(15&n)<<4|r>>2,c[s++]=(3&r)<<6|63&a;return i};function zero$1(e){for(var t=e.length;0<=--t;)e[t]=0}var MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES$1+2)),static_dtree=(zero$1(static_ltree),new Array(2*D_CODES$1)),_dist_code=(zero$1(static_dtree),new Array(DIST_CODE_LEN)),_length_code=(zero$1(_dist_code),new Array(MAX_MATCH$1-MIN_MATCH$1+1)),base_length=(zero$1(_length_code),new Array(LENGTH_CODES$1)),base_dist=(zero$1(base_length),new Array(D_CODES$1)),adler32=(zero$1(base_dist),function(e,t,n,r){for(var a=65535&e|0,i=e>>>16&65535|0,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;i=i+(a=a+t[r++]|0)|0,--o;);a%=65521,i%=65521}return a|i<<16|0}),adler32_1=adler32,makeTable=function(){for(var e=[],t=0;t<256;t++){for(var n=t,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e},crcTable=new Uint32Array(makeTable()),crc32=function(e,t,n,r){var a=crcTable,i=r+n;e^=-1;for(var o=r;o<i;o++)e=e>>>8^a[255&(e^t[o])];return-1^e},crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},_has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!==_typeof(n))throw new TypeError(n+"must be non-object");for(var r in n)_has(n,r)&&(e[r]=n[r])}}return e},flattenChunks=function(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n].length;for(var a=new Uint8Array(t),i=0,o=0,s=e.length;i<s;i++){var c=e[i];a.set(c,o),o+=c.length}return a},common={assign:assign,flattenChunks:flattenChunks},STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new Uint8Array(256),q=0;q<256;q++)_utf8len[q]=252<=q?6:248<=q?5:240<=q?4:224<=q?3:192<=q?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);for(var t,n,r,a,i=e.length,o=0,s=0;s<i;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<i&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),s=a=0;a<o;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<i&&56320==(64512&(r=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(r-56320),s++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t},buf2binstring=function(e,t){if(t<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},buf2string=function(e,t){var n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));for(var r=new Array(2*n),a=0,i=0;i<n;){var o=e[i++];if(o<128)r[a++]=o;else{var s=_utf8len[o];if(4<s)r[a++]=65533,i+=s-1;else{for(o&=2===s?31:3===s?15:7;1<s&&i<n;)o=o<<6|63&e[i++],s--;1<s?r[a++]=65533:o<65536?r[a++]=o:(o-=65536,r[a++]=55296|o>>10&1023,r[a++]=56320|1023&o)}}}return buf2binstring(r,a)},utf8border=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0)&&0!==n&&n+_utf8len[e[n]]>t?n:t},strings={string2buf:string2buf,buf2string:buf2string,utf8border:utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream,BAD$1=16209,TYPE$1=16191,inffast=function(e,t){var n,r,a,i,o,s,c=e.state,l=e.next_in,u=e.input,f=l+(e.avail_in-5),h=e.next_out,d=e.output,g=h-(t-e.avail_out),m=h+(e.avail_out-257),p=c.dmax,_=c.wsize,y=c.whave,v=c.wnext,T=c.window,k=c.hold,b=c.bits,C=c.lencode,I=c.distcode,E=(1<<c.lenbits)-1,S=(1<<c.distbits)-1;e:do{for(b<15&&(k+=u[l++]<<b,b+=8,k+=u[l++]<<b,b+=8),n=C[k&E];;){if(k>>>=r=n>>>24,b-=r,0===(r=n>>>16&255))d[h++]=65535&n;else{if(!(16&r)){if(0==(64&r)){n=C[(65535&n)+(k&(1<<r)-1)];continue}if(32&r){c.mode=TYPE$1;break e}e.msg="invalid literal/length code",c.mode=BAD$1;break e}for(a=65535&n,(r&=15)&&(b<r&&(k+=u[l++]<<b,b+=8),a+=k&(1<<r)-1,k>>>=r,b-=r),b<15&&(k+=u[l++]<<b,b+=8,k+=u[l++]<<b,b+=8),n=I[k&S];;){if(k>>>=r=n>>>24,b-=r,!(16&(r=n>>>16&255))){if(0==(64&r)){n=I[(65535&n)+(k&(1<<r)-1)];continue}e.msg="invalid distance code",c.mode=BAD$1;break e}if(i=65535&n,b<(r&=15)&&(k+=u[l++]<<b,(b+=8)<r)&&(k+=u[l++]<<b,b+=8),p<(i+=k&(1<<r)-1)){e.msg="invalid distance too far back",c.mode=BAD$1;break e}if(k>>>=r,b-=r,(r=h-g)<i){if(y<(r=i-r)&&c.sane){e.msg="invalid distance too far back",c.mode=BAD$1;break e}if(s=T,(o=0)===v){if(o+=_-r,r<a){for(a-=r;d[h++]=T[o++],--r;);o=h-i,s=d}}else if(v<r){if(o+=_+v-r,(r-=v)<a){for(a-=r;d[h++]=T[o++],--r;);if(o=0,v<a){for(a-=r=v;d[h++]=T[o++],--r;);o=h-i,s=d}}}else if(o+=v-r,r<a){for(a-=r;d[h++]=T[o++],--r;);o=h-i,s=d}for(;2<a;)d[h++]=s[o++],d[h++]=s[o++],d[h++]=s[o++],a-=3;a&&(d[h++]=s[o++],1<a)&&(d[h++]=s[o++])}else{for(o=h-i;d[h++]=d[o++],d[h++]=d[o++],d[h++]=d[o++],2<(a-=3););a&&(d[h++]=d[o++],1<a)&&(d[h++]=d[o++])}break}}break}}while(l<f&&h<m);k&=(1<<(b-=(a=b>>3)<<3))-1,e.next_in=l-=a,e.next_out=h,e.avail_in=l<f?f-l+5:5-(l-f),e.avail_out=h<m?m-h+257:257-(h-m),c.hold=k,c.bits=b},MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=function(e,t,n,r,a,i,o,s){for(var c,l,u,f,h,d,g,m,p,_=s.bits,y=0,v=0,T=0,k=0,b=0,C=0,I=0,E=0,S=0,A=0,w=null,D=new Uint16Array(MAXBITS+1),R=new Uint16Array(MAXBITS+1),P=null,y=0;y<=MAXBITS;y++)D[y]=0;for(v=0;v<r;v++)D[t[n+v]]++;for(b=_,k=MAXBITS;1<=k&&0===D[k];k--);if(k<b&&(b=k),0===k)a[i++]=20971520,a[i++]=20971520,s.bits=1;else{for(T=1;T<k&&0===D[T];T++);for(b<T&&(b=T),y=E=1;y<=MAXBITS;y++)if((E=(E<<=1)-D[y])<0)return-1;if(0<E&&(e===CODES$1||1!==k))return-1;for(R[1]=0,y=1;y<MAXBITS;y++)R[y+1]=R[y]+D[y];for(v=0;v<r;v++)0!==t[n+v]&&(o[R[t[n+v]]++]=v);if(d=e===CODES$1?(w=P=o,20):e===LENS$1?(w=lbase,P=lext,257):(w=dbase,P=dext,0),y=T,h=i,I=v=A=0,u=-1,f=(S=1<<(C=b))-1,e===LENS$1&&ENOUGH_LENS$1<S||e===DISTS$1&&ENOUGH_DISTS$1<S)return 1;for(;;){for(p=o[v]+1<d?(m=0,o[v]):o[v]>=d?(m=P[o[v]-d],w[o[v]-d]):(m=96,0),c=1<<(g=y-I),T=l=1<<C;a[h+(A>>I)+(l-=c)]=g<<24|m<<16|p|0,0!==l;);for(c=1<<y-1;A&c;)c>>=1;if(A=0!==c?(A&c-1)+c:0,v++,0==--D[y]){if(y===k)break;y=t[n+o[v]]}if(b<y&&(A&f)!==u){for(h+=T,E=1<<(C=y-(I=0===I?b:I));C+I<k&&!((E-=D[C+I])<=0);)C++,E<<=1;if(S+=1<<C,e===LENS$1&&ENOUGH_LENS$1<S||e===DISTS$1&&ENOUGH_DISTS$1<S)return 1;a[u=A&f]=b<<24|C<<16|h-i|0}}0!==A&&(a[h+A]=y-I<<24|64<<16|0),s.bits=b}return 0},inftrees=inflate_table,CODES=0,LENS=1,DISTS=2,Z_FINISH$1=constants$2.Z_FINISH,Z_BLOCK=constants$2.Z_BLOCK,Z_TREES=constants$2.Z_TREES,Z_OK$1=constants$2.Z_OK,Z_STREAM_END$1=constants$2.Z_STREAM_END,Z_NEED_DICT$1=constants$2.Z_NEED_DICT,Z_STREAM_ERROR$1=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR$1=constants$2.Z_DATA_ERROR,Z_MEM_ERROR$1=constants$2.Z_MEM_ERROR,Z_BUF_ERROR=constants$2.Z_BUF_ERROR,Z_DEFLATED=constants$2.Z_DEFLATED,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var lenfix,distfix,inflateStateCheck=function(e){var t;return!e||!(t=e.state)||t.strm!==e||t.mode<HEAD||t.mode>SYNC?1:0},inflateResetKeep=function(e){var t;return inflateStateCheck(e)?Z_STREAM_ERROR$1:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK$1)},inflateReset=function(e){var t;return inflateStateCheck(e)?Z_STREAM_ERROR$1:((t=e.state).wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e))},inflateReset2=function(e,t){var n,r;return inflateStateCheck(e)||(r=e.state,t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t))?Z_STREAM_ERROR$1:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,inflateReset(e))},inflateInit2=function(e,t){var n;return e?(n=new InflateState,(e.state=n).strm=e,n.window=null,n.mode=HEAD,(n=inflateReset2(e,t))!==Z_OK$1&&(e.state=null),n):Z_STREAM_ERROR$1},inflateInit=function(e){return inflateInit2(e,DEF_WBITS)},virgin=!0,fixedtables=function(e){if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=function(e,t,n,r){var a,e=e.state;return null===e.window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new Uint8Array(e.wsize)),e.wsize<=r?(e.window.set(t.subarray(n-e.wsize,n),0),e.wnext=0,e.whave=e.wsize):(r<(a=e.wsize-e.wnext)&&(a=r),e.window.set(t.subarray(n-r,n-r+a),e.wnext),(r-=a)?(e.window.set(t.subarray(n-r,n),0),e.wnext=r,e.whave=e.wsize):(e.wnext+=a,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=a))),0},inflate$2=function(e,t){var n,r,a,i,o,s,c,l,u,f,h,d,g,m,p,_,y,v,T,k,b,C,I,E,S=0,A=new Uint8Array(4),w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(e)||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;(n=e.state).mode===TYPE&&(n.mode=TYPEDO),o=e.next_out,a=e.output,i=e.next_in,r=e.input,l=n.hold,u=n.bits,f=s=e.avail_in,h=c=e.avail_out,C=Z_OK$1;e:for(;;)switch(n.mode){case HEAD:if(0===n.wrap)n.mode=TYPEDO;else{for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}2&n.wrap&&35615===l?(0===n.wbits&&(n.wbits=15),A[n.check=0]=255&l,A[1]=l>>>8&255,n.check=crc32_1(n.check,A,2,0),u=l=0,n.mode=FLAGS):(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31?(e.msg="incorrect header check",n.mode=BAD):(15&l)!==Z_DEFLATED?(e.msg="unknown compression method",n.mode=BAD):(u-=4,b=8+(15&(l>>>=4)),0===n.wbits&&(n.wbits=b),15<b||b>n.wbits?(e.msg="invalid window size",n.mode=BAD):(n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?DICTID:TYPE,u=l=0)))}break;case FLAGS:for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(n.flags=l,(255&n.flags)!==Z_DEFLATED){e.msg="unknown compression method",n.mode=BAD;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=BAD;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&4&n.wrap&&(A[0]=255&l,A[1]=l>>>8&255,n.check=crc32_1(n.check,A,2,0)),u=l=0,n.mode=TIME;case TIME:for(;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.head&&(n.head.time=l),512&n.flags&&4&n.wrap&&(A[0]=255&l,A[1]=l>>>8&255,A[2]=l>>>16&255,A[3]=l>>>24&255,n.check=crc32_1(n.check,A,4,0)),u=l=0,n.mode=OS;case OS:for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&4&n.wrap&&(A[0]=255&l,A[1]=l>>>8&255,n.check=crc32_1(n.check,A,2,0)),u=l=0,n.mode=EXLEN;case EXLEN:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&4&n.wrap&&(A[0]=255&l,A[1]=l>>>8&255,n.check=crc32_1(n.check,A,2,0)),u=l=0}else n.head&&(n.head.extra=null);n.mode=EXTRA;case EXTRA:if(1024&n.flags&&((d=s<(d=n.length)?s:d)&&(n.head&&(b=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+d),b)),512&n.flags&&4&n.wrap&&(n.check=crc32_1(n.check,r,d,i)),s-=d,i+=d,n.length-=d),n.length))break e;n.length=0,n.mode=NAME;case NAME:if(2048&n.flags){if(0===s)break e;for(d=0;b=r[i+d++],n.head&&b&&n.length<65536&&(n.head.name+=String.fromCharCode(b)),b&&d<s;);if(512&n.flags&&4&n.wrap&&(n.check=crc32_1(n.check,r,d,i)),s-=d,i+=d,b)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=COMMENT;case COMMENT:if(4096&n.flags){if(0===s)break e;for(d=0;b=r[i+d++],n.head&&b&&n.length<65536&&(n.head.comment+=String.fromCharCode(b)),b&&d<s;);if(512&n.flags&&4&n.wrap&&(n.check=crc32_1(n.check,r,d,i)),s-=d,i+=d,b)break e}else n.head&&(n.head.comment=null);n.mode=HCRC;case HCRC:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=BAD;break}u=l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=TYPE;break;case DICTID:for(;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}e.adler=n.check=zswap32(l),u=l=0,n.mode=DICT;case DICT:if(0===n.havedict)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=s,n.hold=l,n.bits=u,Z_NEED_DICT$1;e.adler=n.check=1,n.mode=TYPE;case TYPE:if(t===Z_BLOCK||t===Z_TREES)break e;case TYPEDO:if(n.last)l>>>=7&u,u-=7&u,n.mode=CHECK;else{for(;u<3;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}switch(n.last=1&l,--u,3&(l>>>=1)){case 0:n.mode=STORED;break;case 1:if(fixedtables(n),n.mode=LEN_,t!==Z_TREES)break;l>>>=2,u-=2;break e;case 2:n.mode=TABLE;break;case 3:e.msg="invalid block type",n.mode=BAD}l>>>=2,u-=2}break;case STORED:for(l>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=BAD;break}if(n.length=65535&l,u=l=0,n.mode=COPY_,t===Z_TREES)break e;case COPY_:n.mode=COPY;case COPY:if(d=n.length){if(0===(d=c<(d=s<d?s:d)?c:d))break e;a.set(r.subarray(i,i+d),o),s-=d,i+=d,c-=d,o+=d,n.length-=d}else n.mode=TYPE;break;case TABLE:for(;u<14;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(n.nlen=257+(31&l),l>>>=5,u-=5,n.ndist=1+(31&l),l>>>=5,u-=5,n.ncode=4+(15&l),l>>>=4,u-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=BAD;break}n.have=0,n.mode=LENLENS;case LENLENS:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.lens[w[n.have++]]=7&l,l>>>=3,u-=3}for(;n.have<19;)n.lens[w[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},C=inftrees(CODES,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,C){e.msg="invalid code lengths set",n.mode=BAD;break}n.have=0,n.mode=CODELENS;case CODELENS:for(;n.have<n.nlen+n.ndist;){for(;_=(S=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,y=65535&S,!((p=S>>>24)<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(y<16)l>>>=p,u-=p,n.lens[n.have++]=y;else{if(16===y){for(E=p+2;u<E;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(l>>>=p,u-=p,0===n.have){e.msg="invalid bit length repeat",n.mode=BAD;break}b=n.lens[n.have-1],d=3+(3&l),l>>>=2,u-=2}else if(17===y){for(E=p+3;u<E;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}b=0,d=3+(7&(l>>>=p)),l>>>=3,u=u-p-3}else{for(E=p+7;u<E;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}b=0,d=11+(127&(l>>>=p)),l>>>=7,u=u-p-7}if(n.have+d>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=BAD;break}for(;d--;)n.lens[n.have++]=b}}if(n.mode===BAD)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=BAD;break}if(n.lenbits=9,I={bits:n.lenbits},C=inftrees(LENS,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,C){e.msg="invalid literal/lengths set",n.mode=BAD;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},C=inftrees(DISTS,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,C){e.msg="invalid distances set",n.mode=BAD;break}if(n.mode=LEN_,t===Z_TREES)break e;case LEN_:n.mode=LEN;case LEN:if(6<=s&&258<=c){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=s,n.hold=l,n.bits=u,inffast(e,h),o=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,l=n.hold,u=n.bits,n.mode===TYPE&&(n.back=-1);break}for(n.back=0;_=(S=n.lencode[l&(1<<n.lenbits)-1])>>>16&255,y=65535&S,!((p=S>>>24)<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(_&&0==(240&_)){for(v=p,T=_,k=y;_=(S=n.lencode[k+((l&(1<<v+T)-1)>>v)])>>>16&255,y=65535&S,!(v+(p=S>>>24)<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}l>>>=v,u-=v,n.back+=v}if(l>>>=p,u-=p,n.back+=p,n.length=y,0===_){n.mode=LIT;break}if(32&_){n.back=-1,n.mode=TYPE;break}if(64&_){e.msg="invalid literal/length code",n.mode=BAD;break}n.extra=15&_,n.mode=LENEXT;case LENEXT:if(n.extra){for(E=n.extra;u<E;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=DIST;case DIST:for(;_=(S=n.distcode[l&(1<<n.distbits)-1])>>>16&255,y=65535&S,!((p=S>>>24)<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(0==(240&_)){for(v=p,T=_,k=y;_=(S=n.distcode[k+((l&(1<<v+T)-1)>>v)])>>>16&255,y=65535&S,!(v+(p=S>>>24)<=u);){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}l>>>=v,u-=v,n.back+=v}if(l>>>=p,u-=p,n.back+=p,64&_){e.msg="invalid distance code",n.mode=BAD;break}n.offset=y,n.extra=15&_,n.mode=DISTEXT;case DISTEXT:if(n.extra){for(E=n.extra;u<E;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=BAD;break}n.mode=MATCH;case MATCH:if(0===c)break e;if(n.offset>(d=h-c)){if((d=n.offset-d)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=BAD;break}g=d>n.wnext?(d-=n.wnext,n.wsize-d):n.wnext-d,d>n.length&&(d=n.length),m=n.window}else m=a,g=o-n.offset,d=n.length;for(c-=d=c<d?c:d,n.length-=d;a[o++]=m[g++],--d;);0===n.length&&(n.mode=LEN);break;case LIT:if(0===c)break e;a[o++]=n.length,c--,n.mode=LEN;break;case CHECK:if(n.wrap){for(;u<32;){if(0===s)break e;s--,l|=r[i++]<<u,u+=8}if(h-=c,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=(n.flags?crc32_1:adler32_1)(n.check,a,h,o-h)),h=c,4&n.wrap&&(n.flags?l:zswap32(l))!==n.check){e.msg="incorrect data check",n.mode=BAD;break}u=l=0}n.mode=LENGTH;case LENGTH:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,l+=r[i++]<<u,u+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=BAD;break}u=l=0}n.mode=DONE;case DONE:C=Z_STREAM_END$1;break e;case BAD:C=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;default:return Z_STREAM_ERROR$1}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=s,n.hold=l,n.bits=u,(n.wsize||h!==e.avail_out&&n.mode<BAD&&(n.mode<CHECK||t!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,h-e.avail_out),h-=e.avail_out,e.total_in+=f-=e.avail_in,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=(n.flags?crc32_1:adler32_1)(n.check,a,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(n.mode===TYPE?128:0)+(n.mode===LEN_||n.mode===COPY_?256:0),C=(0==f&&0===h||t===Z_FINISH$1)&&C===Z_OK$1?Z_BUF_ERROR:C},inflateEnd=function(e){var t;return inflateStateCheck(e)?Z_STREAM_ERROR$1:((t=e.state).window&&(t.window=null),e.state=null,Z_OK$1)},inflateGetHeader=function(e,t){return inflateStateCheck(e)||0==(2&(e=e.state).wrap)?Z_STREAM_ERROR$1:((e.head=t).done=!1,Z_OK$1)},inflateSetDictionary=function(e,t){var n,r=t.length;return inflateStateCheck(e)||0!==(n=e.state).wrap&&n.mode!==DICT?Z_STREAM_ERROR$1:n.mode===DICT&&adler32_1(1,t,r,0)!==n.check?Z_DATA_ERROR$1:updatewindow(e,t,r,r)?(n.mode=MEM,Z_MEM_ERROR$1):(n.havedict=1,Z_OK$1)},inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset,inflateReset2:inflateReset2,inflateResetKeep:inflateResetKeep,inflateInit:inflateInit,inflateInit2:inflateInit2,inflate:inflate$2,inflateEnd:inflateEnd,inflateGetHeader:inflateGetHeader,inflateSetDictionary:inflateSetDictionary,inflateInfo:inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader,toString=Object.prototype.toString,Z_NO_FLUSH=constants$2.Z_NO_FLUSH,Z_FINISH=constants$2.Z_FINISH,Z_OK=constants$2.Z_OK,Z_STREAM_END=constants$2.Z_STREAM_END,Z_NEED_DICT=constants$2.Z_NEED_DICT,Z_STREAM_ERROR=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR=constants$2.Z_DATA_ERROR,Z_MEM_ERROR=constants$2.Z_MEM_ERROR;function Inflate$1(e){this.options=common.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options,e=(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits)&&(t.windowBits=-15),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0,inflate_1$2.inflateInit2(this.strm,t.windowBits));if(e!==Z_OK)throw new Error(messages[e]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw)&&(e=inflate_1$2.inflateSetDictionary(this.strm,t.dictionary))!==Z_OK)throw new Error(messages[e])}function inflate$1(e,t){t=new Inflate$1(t);if(t.push(e),t.err)throw t.msg||messages[t.err];return t.result}function inflateRaw$1(e,t){return(t=t||{}).raw=!0,inflate$1(e,t)}Inflate$1.prototype.push=function(e,t){var n,r,a=this.strm,i=this.options.chunkSize,o=this.options.dictionary;if(this.ended)return!1;for(r=t===~~t?t:!0===t?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===toString.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),(n=inflate_1$2.inflate(a,r))===Z_NEED_DICT&&o&&((n=inflate_1$2.inflateSetDictionary(a,o))===Z_OK?n=inflate_1$2.inflate(a,r):n===Z_DATA_ERROR&&(n=Z_NEED_DICT));0<a.avail_in&&n===Z_STREAM_END&&0<a.state.wrap&&0!==e[a.next_in];)inflate_1$2.inflateReset(a),n=inflate_1$2.inflate(a,r);switch(n){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(n),!(this.ended=!0)}var s,c,l,u=a.avail_out;if(!a.next_out||0!==a.avail_out&&n!==Z_STREAM_END||("string"===this.options.to?(s=strings.utf8border(a.output,a.next_out),c=a.next_out-s,l=strings.buf2string(a.output,s),a.next_out=c,a.avail_out=i-c,c&&a.output.set(a.output.subarray(s,s+c),0),this.onData(l)):this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out))),n!==Z_OK||0!==u){if(n===Z_STREAM_END)return n=inflate_1$2.inflateEnd(this.strm),this.onEnd(n),this.ended=!0;if(0===a.avail_in)break}}return!0},Inflate$1.prototype.onData=function(e){this.chunks.push(e)},Inflate$1.prototype.onEnd=function(e){e===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate$1,inflate:inflate$1,inflateRaw:inflateRaw$1,ungzip:inflate$1,constants:constants$2},ungzip=inflate_1$1.ungzip,_={},ArrayProto=Array.prototype,ObjProto=Object.prototype,slice=ArrayProto.slice,nativeToString=ObjProto.toString,nativeHasOwnProperty=Object.prototype.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeIsArray=Array.isArray,breaker={},logger=(_.checkSettings=function(e){if(e&&!_.isStrEmpty(e.appId)&&!_.isStrEmpty(e.serverUrl))return e.appId=_.checkAppId(e.appId),e.serverUrl=_.checkUrl(e.serverUrl),_.isStrEmpty(e.templateCode)&&(e.templateCode=Config.TEMPLATE_DEFAULT),e},_.checkAppId=function(e){return e=e.replace(/\s*/g,"")},_.checkUrl=function(e){return e=e.replace(/\s*/g,""),e=_.url("basic",e)},_.url=(()=>{function a(){return new RegExp(/(.*?)\.?([^.]*?)\.(com|net|org|biz|ws|in|me|co\.uk|co|org\.uk|ltd\.uk|plc\.uk|me\.uk|edu|mil|br\.com|cn\.com|eu\.com|hu\.com|no\.com|qc\.com|sa\.com|se\.com|se\.net|us\.com|uy\.com|ac|co\.ac|gv\.ac|or\.ac|ac\.ac|af|am|as|at|ac\.at|co\.at|gv\.at|or\.at|asn\.au|com\.au|edu\.au|org\.au|net\.au|id\.au|be|ac\.be|adm\.br|adv\.br|am\.br|arq\.br|art\.br|bio\.br|cng\.br|cnt\.br|com\.br|ecn\.br|eng\.br|esp\.br|etc\.br|eti\.br|fm\.br|fot\.br|fst\.br|g12\.br|gov\.br|ind\.br|inf\.br|jor\.br|lel\.br|med\.br|mil\.br|net\.br|nom\.br|ntr\.br|odo\.br|org\.br|ppg\.br|pro\.br|psc\.br|psi\.br|rec\.br|slg\.br|tmp\.br|tur\.br|tv\.br|vet\.br|zlg\.br|br|ab\.ca|bc\.ca|mb\.ca|nb\.ca|nf\.ca|ns\.ca|nt\.ca|on\.ca|pe\.ca|qc\.ca|sk\.ca|yk\.ca|ca|cc|ac\.cn|net\.cn|com\.cn|edu\.cn|gov\.cn|org\.cn|bj\.cn|sh\.cn|tj\.cn|cq\.cn|he\.cn|nm\.cn|ln\.cn|jl\.cn|hl\.cn|js\.cn|zj\.cn|ah\.cn|gd\.cn|gx\.cn|hi\.cn|sc\.cn|gz\.cn|yn\.cn|xz\.cn|sn\.cn|gs\.cn|qh\.cn|nx\.cn|xj\.cn|tw\.cn|hk\.cn|mo\.cn|cn|cx|cz|de|dk|fo|com\.ec|tm\.fr|com\.fr|asso\.fr|presse\.fr|fr|gf|gs|co\.il|net\.il|ac\.il|k12\.il|gov\.il|muni\.il|ac\.in|co\.in|org\.in|ernet\.in|gov\.in|net\.in|res\.in|is|it|ac\.jp|co\.jp|go\.jp|or\.jp|ne\.jp|ac\.kr|co\.kr|go\.kr|ne\.kr|nm\.kr|or\.kr|li|lt|lu|asso\.mc|tm\.mc|com\.mm|org\.mm|net\.mm|edu\.mm|gov\.mm|ms|nl|no|nu|pl|ro|org\.ro|store\.ro|tm\.ro|firm\.ro|www\.ro|arts\.ro|rec\.ro|info\.ro|nom\.ro|nt\.ro|se|si|com\.sg|org\.sg|net\.sg|gov\.sg|sk|st|tf|ac\.th|co\.th|go\.th|mi\.th|net\.th|or\.th|tm|to|com\.tr|edu\.tr|gov\.tr|k12\.tr|net\.tr|org\.tr|com\.tw|org\.tw|net\.tw|ac\.uk|uk\.com|uk\.net|gb\.com|gb\.net|vg|sh|kz|ch|info|ua|gov|name|pro|ie|hk|com\.hk|org\.hk|net\.hk|edu\.hk|us|tk|cd|by|ad|lv|eu\.lv|bz|es|jp|cl|ag|mobi|eu|co\.nz|org\.nz|net\.nz|maori\.nz|iwi\.nz|io|la|md|sc|sg|vc|tw|travel|my|se|tv|pt|com\.pt|edu\.pt|asia|fi|com\.ve|net\.ve|fi|org\.ve|web\.ve|info\.ve|co\.ve|tel|im|gr|ru|net\.ru|org\.ru|hr|com\.hr|ly|xyz)$/)}function i(e,t){var n=e.charAt(0),t=t.split(n);return n===e?t:t[(e=parseInt(e.substring(1),10))<0?t.length+e:e-1]}function o(e,t){for(var n,r=e.charAt(0),a=t.split("&"),i=[],o={},s=e.substring(1),c=0,l=a.length;c<l;c++)if(""!==(i=(i=a[c].match(/(.*?)=(.*)/))||[a[c],a[c],""])[1].replace(/\s/g,"")){if(i[2]=(n=i[2]||"",_.decodeURIComponent(n.replace(/\+/g," "))),s===i[1])return i[2];(n=i[1].match(/(.*)\[([0-9]+)\]/))?(o[n[1]]=o[n[1]]||[],o[n[1]][n[2]]=i[2]):o[i[1]]=i[2]}return r===e?o:o[s]}return function(e,t){var n,r={};if("tld?"===e)return a();if(t=t||window.location.toString(),!e)return t;if(e=e.toString(),t.match(/^mailto:([^/].+)/))n=t.match(/^mailto:([^/].+)/),r.protocol="mailto",r.email=n[1];else{if((t=t.match(/(.*?)\/#!(.*)/)?(n=t.match(/(.*?)\/#!(.*)/))[1]+n[2]:t).match(/(.*?)#(.*)/)&&(n=t.match(/(.*?)#(.*)/),r.hash=n[2],t=n[1]),r.hash&&e.match(/^#/))return o(e,r.hash);if(t.match(/(.*?)\?(.*)/)&&(n=t.match(/(.*?)\?(.*)/),r.query=n[2],t=n[1]),r.query&&e.match(/^\?/))return o(e,r.query);if(t.match(/(.*?):?\/\/(.*)/)&&(n=t.match(/(.*?):?\/\/(.*)/),r.protocol=n[1].toLowerCase(),t=n[2]),t.match(/(.*?)(\/.*)/)&&(n=t.match(/(.*?)(\/.*)/),r.path=n[2],t=n[1]),r.path=(r.path||"").replace(/^([^/])/,"/$1").replace(/\/$/,""),(e=e.match(/^[-0-9]+$/)?e.replace(/^([^/])/,"/$1"):e).match(/^\//))return i(e,r.path.substring(1));if((n=(n=i("/-1",r.path.substring(1)))&&n.match(/(.*?)\.(.*)/))&&(r.file=n[0],r.filename=n[1],r.fileext=n[2]),t.match(/(.*):([0-9]+)$/)&&(n=t.match(/(.*):([0-9]+)$/),r.port=n[2],t=n[1]),t.match(/(.*?)@(.*)/)&&(n=t.match(/(.*?)@(.*)/),r.auth=n[1],t=n[2]),r.auth&&(n=r.auth.match(/(.*):(.*)/),r.user=n?n[1]:r.auth,r.pass=n?n[2]:void 0),r.hostname=t.toLowerCase(),"."===e.charAt(0))return i(e,r.hostname);a()&&(n=r.hostname.match(a()))&&(r.tld=n[3],r.domain=n[2]?n[2]+"."+n[3]:void 0,r.sub=n[1]||void 0);t=r.port?":"+r.port:"";r.protocol=r.protocol||window.location.protocol.replace(":",""),r.port=r.port||("https"===r.protocol?"443":"80"),r.protocol=r.protocol||("443"===r.port?"https":"http"),r.basic=r.protocol+"://"+r.hostname+t}return e in r?r[e]:"{}"===e?r:""}})(),_.isStrEmpty=function(e){return!e||0===e.length},_.isArray=nativeIsArray||function(e){return"[object Array]"===nativeToString.call(e)},_.UUID=function(){var e=Date.now();return String(Math.random()).replace(".","").slice(1,11)+"-"+e},_.each=function(e,t,n){if(null==e)return!1;if(nativeForEach&&e.forEach===nativeForEach)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,a=e.length;r<a;r++)if(r in e&&t.call(n,e[r],r,e)===breaker)return!1}else for(var i in e)if(nativeHasOwnProperty.call(e,i)&&t.call(n,e[i],i,e)===breaker)return!1},_.extend=function(n){return _.each(slice.call(arguments,1),function(e){for(var t in e)void 0!==e[t]&&(n[t]=e[t])}),n},_.extend1=function(n){return _.each(slice.call(arguments,1),function(e){for(var t in e)void 0!==e[t]&&(n[t.toLowerCase()]=e[t])}),n},_.hexToArrayBuffer=function(e){return new Uint8Array(e.match(/[\da-f]{2}/gi).map(function(e){return parseInt(e,16)})).buffer},_.sign=function(e,t){e=_.sha256(e+t+"thinkingdata-remote-config");return encode(_.hexToArrayBuffer(e))},_.sha256=function(e){function _(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function y(e,t){return e>>>t|e<<32-t}for(var t=((e,t)=>{var n,r=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),a=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),i=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var o,s=0;s<e.length;s+=16){for(var c=a[0],l=a[1],u=a[2],f=a[3],h=a[4],d=a[5],g=a[6],m=a[7],p=0;p<64;p++)i[p]=p<16?e[p+s]:_(_(_(y(o=i[p-2],17)^y(o,19)^o>>>10,i[p-7]),y(o=i[p-15],7)^y(o,18)^o>>>3),i[p-16]),o=_(_(_(_(m,y(h,6)^y(h,11)^y(h,25)),h&d^~h&g),r[p]),i[p]),n=_(y(c,2)^y(c,13)^y(c,22),c&l^c&u^l&u),m=g,g=d,d=h,h=_(f,o),f=u,u=l,l=c,c=_(o,n);a[0]=_(c,a[0]),a[1]=_(l,a[1]),a[2]=_(u,a[2]),a[3]=_(f,a[3]),a[4]=_(h,a[4]),a[5]=_(d,a[5]),a[6]=_(g,a[6]),a[7]=_(m,a[7])}return a})((e=>{for(var t=Array(),n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t})(e=(e=>{e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):t=127<r&&r<2048?(t+=String.fromCharCode(r>>6|192))+String.fromCharCode(63&r|128):(t=(t+=String.fromCharCode(r>>12|224))+String.fromCharCode(r>>6&63|128))+String.fromCharCode(63&r|128)}return t})(e)),8*e.length),n="0123456789abcdef",r="",a=0;a<4*t.length;a++)r+=n.charAt(t[a>>2]>>8*(3-a%4)+4&15)+n.charAt(t[a>>2]>>8*(3-a%4)&15);return r},_.parseJsonConfig=function(n,e){n&&e&&_.each(e,function(e,t){e===Config.DATE_TYPE&&(e=n[t])&&(n[t]=new Date(e))})},_.isDate=function(e){return"[object Date]"===nativeToString.call(e)},_.isString=function(e){return"[object String]"===nativeToString.call(e)},_.isBoolean=function(e){return"[object Boolean]"===nativeToString.call(e)},_.isNumber=function(e){return"[object Number]"===nativeToString.call(e)&&/[\d\.]+/.test(String(e))},_.isObject=function(e){return"[object Object]"===nativeToString.call(e)&&null!=e},_.isFunction=function(e){try{return"function"==typeof e}catch(e){return!1}},_.stringToBoolean=function(e){switch(e.toLowerCase().trim()){case"true":return!0;case"false":return!1;default:return}},_.formatDate=function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+((e=e.getMilliseconds())<100&&9<e?"0"+e:e<10?"00"+e:e)},_.parseConfigToJson=function(e){var n,r;return e?(n={},r={},_.each(e,function(e,t){_.isDate(e)?(n[t]=_.formatDate(e),r[t]=Config.DATE_TYPE):n[t]=e}),{config:n,type:r}):{}},_.isDebug=function(e){return"debug"===e||"debugOnly"===e},_.parseResponse=function(e){var t=e.data;if(t.data){var e=e.header,n=e.Timestamp||e.timestamp;if((e.Sign||e.sign)!==_.sign(n,t.data))return{code:Config.SIGN_ILLEGAL,msg:"sign illegal"};t.timeStamp=Number(n);e=decode(t.data),n=ungzip(e),e=_.arrayBufferToString(n);t.data=JSON.parse(e)}return t},_.arrayBufferToString=function(e){for(var t=new Uint8Array(e),n="",r=0;r<t.length;){var a,i,o=t[r];o<128?(n+=String.fromCharCode(o),r+=1):192<=o&&o<224?(a=t[r+1],n+=String.fromCharCode((31&o)<<6|63&a),r+=2):224<=o&&o<240?(a=t[r+1],i=t[r+2],n+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),r+=3):240<=o&&o<248&&(i=(7&o)<<18|(63&t[r+1])<<12|(63&t[r+2])<<6|63&t[r+3],i-=65536,n+=String.fromCharCode(55296+(i>>10),56320+(1023&i)),r+=4)}return n},_.paramType=function(e){return Object.prototype.toString.call(e).replace("[object ","").replace("]","")},_.addEvent=function(e,t,n,r){if(document.addEventListener)if("Array"!==this.paramType(e)&&"HTMLCollection"!==this.paramType(e)||!e.length||e===window)e.addEventListener(t,n,r);else for(var a=0;a<e.length;a++)this.addEvent(e[a],t,n,r);else if(e.length&&e!==window)for(var i=0;i<e.length;i++)this.addEvent(e[i],t,n);else e.attachEvent("on"+t,function(){return n.call(e,window.event)})},_.isCCAndroid=function(){return!(!cc.sys.isNative||"Android"!==cc.sys.os)},_.isCCIOS=function(){return!(!cc.sys.isNative||"iOS"!==cc.sys.os)},"object"===_typeof(logger)?logger:{}),TDObject=(logger.info=function(){if("object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&logger.enabled)try{return arguments[0]="[ThinkingData] Info: "+arguments[0],logger.listener&&logger.listener(arguments[0]),console.log.apply(console,arguments)}catch(e){logger.listener&&logger.listener(arguments[0]),console.log("[ThinkingData] Info: "+arguments[0])}},logger.info1=function(e,t){logger.enabled&&(logger.listener&&logger.listener(e+JSON.stringify(t)),logger.info(e+JSON.stringify(t,null,4)))},logger.warn=function(){if("object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&logger.enabled)try{return arguments[0]="[ThinkingData] Warning: "+arguments[0],console.warn.apply(console,arguments)}catch(e){console.warn("[ThinkingData] Warning: "+arguments[0])}},(()=>{function r(e){_classCallCheck(this,r),this.keyList=[],e&&(this.configValues=e.first,this.defaultValues=e.second)}return _createClass(r,[{key:"get",value:function(e,t){return void 0!==this.configValues&&(this.keyList.push(e),_.isString(e)&&_.isObject(this.configValues)||_.isNumber(e)&&_.isArray(this.configValues)?this.configValues=this.configValues[e]:this.configValues=t,void 0===this.configValues&&this.keyList.length<=2&&(this.configValues=this.getDefaultValue(),this.defaultValues=void 0),void 0===this.configValues)&&(this.configValues=t),this}},{key:"getDefaultValue",value:function(){if(void 0!==this.defaultValues){for(var e=this.defaultValues,t=0;t<this.keyList.length;t++)if(void 0===(e=e[this.keyList[t]]))break;return e}}},{key:"arrayWithFilter",value:function(e){if(_.isFunction(e)&&void 0!==this.configValues)if(_.isArray(this.configValues)){for(var t=[],n=0;n<this.configValues.length;n++)!0===e(new r({first:this.configValues[n]}))&&t.push(this.configValues[n]);this.configValues=t}else this.configValues=void 0;return this}},{key:"stringValue",value:function(){if(void 0!==this.configValues)return _.isString(this.configValues)?this.configValues:String(this.configValues)}},{key:"numberValue",value:function(){if(void 0!==this.configValues){if(_.isNumber(this.configValues))return this.configValues;if(_.isString(this.configValues)){var e=Number(this.configValues);if(!Number.isNaN(e))return e}}}},{key:"booleanValue",value:function(){if(void 0!==this.configValues)return _.isBoolean(this.configValues)?this.configValues:_.isString(this.configValues)?_.stringToBoolean(this.configValues):void 0}},{key:"objectValue",value:function(){if(void 0!==this.configValues){if(_.isObject(this.configValues))return this.configValues;if(_.isString(this.configValues)){var e=JSON.parse(this.configValues);if(_.isObject(e))return e}}}},{key:"arrayValue",value:function(){if(void 0!==this.configValues){if(_.isArray(this.configValues))return this.configValues;if(_.isString(this.configValues)){var e=JSON.parse(this.configValues);if(_.isArray(e))return e}}}}])})()),runtime=(o=>{var c,e=Object.prototype,l=e.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",a=t.toStringTag||"@@toStringTag";function i(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{i({},"")}catch(e){i=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a,i,o,s,t=t&&t.prototype instanceof _?t:_,t=Object.create(t.prototype),r=new S(r||[]);return u(t,"_invoke",{value:(a=e,i=n,o=r,s=h,function(e,t){if(s===g)throw new Error("Generator is already running");if(s===m){if("throw"===e)throw t;return{value:c,done:!0}}for(o.method=e,o.arg=t;;){var n=o.delegate;if(n){n=function e(t,n){var r=n.method;var a=t.iterator[r];if(a===c)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=c,e(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;r=f(a,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,p;a=r.arg;if(!a)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p;{if(!a.done)return a;n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=c)}n.delegate=null;return p}(n,o);if(n){if(n===p)continue;return n}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(s===h)throw s=m,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);s=g;n=f(a,i,o);if("normal"===n.type){if(s=o.done?m:d,n.arg!==p)return{value:n.arg,done:o.done}}else"throw"===n.type&&(s=m,o.method="throw",o.arg=n.arg)}})}),t}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}o.wrap=s;var h="suspendedStart",d="suspendedYield",g="executing",m="completed",p={};function _(){}function y(){}function v(){}i(t={},r,function(){return this});var T=Object.getPrototypeOf,k=((T=T&&T(T(A([]))))&&T!==e&&l.call(T,r)&&(t=T),v.prototype=_.prototype=Object.create(t));function b(e){["next","throw","return"].forEach(function(t){i(e,t,function(e){return this._invoke(t,e)})})}function C(o,s){var t;u(this,"_invoke",{value:function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,a){var i,e=f(o[e],o,n);if("throw"!==e.type)return(n=(i=e.arg).value)&&"object"==typeof n&&l.call(n,"__await")?s.resolve(n.__await).then(function(e){t("next",e,r,a)},function(e){t("throw",e,r,a)}):s.resolve(n).then(function(e){i.value=e,r(i)},function(e){return t("throw",e,r,a)});a(e.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}})}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function A(t){if(null!=t){var n,e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(l.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=c,e.done=!0,e}).next=e}throw new TypeError(typeof t+" is not iterable")}return u(k,"constructor",{value:y.prototype=v,configurable:!0}),u(v,"constructor",{value:y,configurable:!0}),y.displayName=i(v,a,"GeneratorFunction"),o.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,i(e,a,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},b(C.prototype),i(C.prototype,n,function(){return this}),o.AsyncIterator=C,o.async=function(e,t,n,r,a){void 0===a&&(a=Promise);var i=new C(s(e,t,n,r),a);return o.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},b(k),i(k,a,"Generator"),i(k,r,function(){return this}),i(k,"toString",function(){return"[object Generator]"}),o.keys=function(e){var t,n=Object(e),r=[];for(t in n)r.push(t);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=A,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return i.type="throw",i.arg=n,r.next=e,t&&(r.method="next",r.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],i=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var o=l.call(a,"catchLoc"),s=l.call(a,"finallyLoc");if(o&&s){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&l.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}var i=(a=a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc?null:a)?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,r,a=this.tryEntries[t];if(a.tryLoc===e)return"throw"===(n=a.completion).type&&(r=n.arg,E(a)),r}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=c),p}},o})("object"==typeof module?module.exports:{});try{regeneratorRuntime=runtime}catch(e){"object"==typeof globalThis&&(globalThis.regeneratorRuntime=runtime)}var DB_NAME="thinkingdata",TABLE_NAME="data",PlatformProxy=(()=>{function t(e){_classCallCheck(this,t),this.api=e}return _createClass(t,[{key:"openDb",value:function(){return new Promise(function(t,e){var n=indexedDB.open(DB_NAME,1);n.onerror=function(e){t(void 0)},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(e){e.target.result.createObjectStore(TABLE_NAME,{keyPath:"id",autoIncrement:!0}).createIndex("key","key",{unique:!0})}})}},{key:"initPageLifeCycle",value:function(e){"onvisibilitychange"in document&&_.addEvent(document,"visibilitychange",function(){e()})}},{key:"setStorage",value:(r=_asyncToGenerator(_regenerator().m(function e(a,i,t){var o=this;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(this.db){e.n=2;break}return e.n=1,this.openDb();case 1:this.db=e.v;case 2:return e.a(2,new Promise(function(t,e){var n=o.db.transaction(TABLE_NAME,"readwrite").objectStore(TABLE_NAME),r=n.index("key").get(a);r.onsuccess=function(e){var e=e.target.result;e?(e.value=i,(e=n.put(e)).onsuccess=function(){t(!0)},e.onerror=function(e){t(!1)}):((e=n.add({key:a,value:i})).onsuccess=function(){t(!0)},e.onerror=function(e){t(!1)})},r.onerror=function(e){t(!1)}}))}},e,this)})),function(e,t,n){return r.apply(this,arguments)})},{key:"getStorage",value:(n=_asyncToGenerator(_regenerator().m(function e(r,t){var a=this;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(this.db){e.n=2;break}return e.n=1,this.openDb();case 1:this.db=e.v;case 2:return e.a(2,new Promise(function(t,e){var n=a.db.transaction(TABLE_NAME,"readonly").objectStore(TABLE_NAME).index("key").get(r);n.onsuccess=function(e){e=e.target.result;t(e?e.value:void 0)},n.onerror=function(e){t(void 0)}}))}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"readFile",value:function(e){return"{}"}},{key:"getStorageSync",value:function(e){return{}}},{key:"request",value:function(n){return new Promise(function(t,e){try{var r=null;(r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open(n.method,n.url,!0),_.each(n.header,function(e,t){r.setRequestHeader(t,e)}),r.onreadystatechange=function(){var e,n;r.readyState===XMLHttpRequest.DONE&&(200<=r.status&&r.status<300||304===r.status)&&(e=r.getAllResponseHeaders().trim().split(/[\r\n]+/),n={},e.forEach(function(e){var e=e.split(": "),t=e.shift(),e=e.join(": ");n[t]=e}),t({data:JSON.parse(r.response),header:n}))},n.data?r.send(JSON.stringify(n.data)):r.send()}catch(e){t({data:{code:-10003,msg:"error"},header:{}})}})}},{key:"getSystemInfo",value:function(){var e=this.getAnalyticGlobalData();return e?e.getPresetProperties().toEventPresetProperties():{}}},{key:"isNetWorkConnect",value:function(){return!navigator||navigator.onLine}},{key:"onNetworkStatusChange",value:function(e){this.api.addEventListener("online",function(){e({isConnected:!0})}),this.api.addEventListener("offline",function(){e({isConnected:!1})})}},{key:"getAnalyticGlobalData",value:function(){return this.api.tdanalytics2024}},{key:"setGlobalData",value:function(e){this.api.tdremoteconfig2024=e}}],[{key:"createInstance",value:function(){return new t(window)}}]);var n,r})(),PlatformAPI=(()=>_createClass(function e(){_classCallCheck(this,e)},null,[{key:"_getCurrentPlatform",value:function(){return this.currentPlatform||(this.currentPlatform=PlatformProxy.createInstance())}},{key:"initPageLifeCycle",value:function(e){return this._getCurrentPlatform().initPageLifeCycle(e)}},{key:"setStorage",value:function(e,t,n){return this._getCurrentPlatform().setStorage(e,t,n)}},{key:"getStorage",value:function(e,t){return this._getCurrentPlatform().getStorage(e,t)}},{key:"readFile",value:function(e){return this._getCurrentPlatform().readFile(e)}},{key:"getStorageSync",value:function(e){return this._getCurrentPlatform().getStorageSync(e)}},{key:"request",value:function(e){return this._getCurrentPlatform().request(e)}},{key:"getSystemInfo",value:function(){return this._getCurrentPlatform().getSystemInfo()}},{key:"isNetWorkConnect",value:function(){return this._getCurrentPlatform().isNetWorkConnect()}},{key:"onNetworkStatusChange",value:function(e){return this._getCurrentPlatform().onNetworkStatusChange(e)}},{key:"getAnalyticGlobalData",value:function(){return this._getCurrentPlatform().getAnalyticGlobalData()}},{key:"setGlobalData",value:function(e){this._getCurrentPlatform().setGlobalData(e)}}]))(),AnalyticUtil={},CLIENT_DEBUG_EVENT="te_ops_client_debug_test",CLIENT_RISK_EVENT="te_ops_client_risk_record",TDAnalytics=PlatformAPI.getAnalyticGlobalData(),AccountTaskQueue=(AnalyticUtil.getCurrentTimeStamp=function(){return Date.now()},AnalyticUtil.getCurrentDate=function(){return new Date(Date.now())},AnalyticUtil.trackDebugFailEvent=function(e,t){TDAnalytics&&TDAnalytics.trackInternal({eventName:CLIENT_DEBUG_EVENT,properties:{"#rcc_pull_result":{business_type:1,is_pull_success:!1,pull_fail_code:t}},debugMode:"debugOnly"},e)},AnalyticUtil.trackRiskEvent=function(e){TDAnalytics&&TDAnalytics.trackInternal({eventName:CLIENT_RISK_EVENT,properties:{"#ops_risk_type":1}},e)},AnalyticUtil.getAccountId=function(e){return TDAnalytics?TDAnalytics.getAccountId(e):""},AnalyticUtil.getDistinctId=function(e){return TDAnalytics?TDAnalytics.getDistinctId(e):""},AnalyticUtil.getDeviceId=function(){return TDAnalytics?TDAnalytics.getDeviceId():""},AnalyticUtil.registerAnalyticsObserver=function(e,t){TDAnalytics&&TDAnalytics.registerAnalyticsObserver(e,t)},(()=>{function e(){_classCallCheck(this,e),this.tasks=[],this.timeStamp=0}return _createClass(e,[{key:"addTask",value:function(e,t){var n=function(){return e.apply(this,t)}.bind(this);this.tasks.push(n),this.run()}},{key:"run",value:(t=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(this.tasks.length<=0)return e.a(2);e.n=1;break;case 1:if(0===this.timeStamp||3e3<AnalyticUtil.getCurrentTimeStamp()-this.timeStamp)return this.timeStamp=AnalyticUtil.getCurrentTimeStamp(),t=this.tasks.shift(),e.n=2,t();e.n=3;break;case 2:this.timeStamp=0,this.run();case 3:return e.a(2)}},e,this)})),function(){return t.apply(this,arguments)})}],[{key:"getInstance",value:function(){return e.instance=e.instance?e.instance:new e}}]);var t})()),ClientUserManager=(()=>{function t(e){_classCallCheck(this,t),this.tUsers=e+"_users"}return _createClass(t,[{key:"loadClientUserId",value:function(){AccountTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){var t,n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.getStorage(this.tUsers,!0);case 1:if(t=e.v,_.isArray(t)&&1e3<t.length)return n=t.length-900,t.splice(0,n),e.n=2,PlatformAPI.setStorage(this.tUsers,t,!0);e.n=2;break;case 2:return e.a(2)}},e,this)})).bind(this))}},{key:"getClientUserId",value:function(l,u,f){AccountTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){var t,n,r,a,i,o,s,c;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.getStorage(this.tUsers,!0);case 1:t=e.v,_.isArray(t)||(t=[]),_.isStrEmpty(l)?(n=this.findUserByDistinctId(t,u))?(f(n.clientUserId),e.n=4):e.n=2:e.n=5;break;case 2:return r=_.UUID(),e.n=3,this.createNewUser(t,"",u,r);case 3:f(r);case 4:e.n=16;break;case 5:for(i=a=void 0,o=0;o<t.length;o++)t[o].accountId===l&&(a=t[o]),t[o].distinctId===u&&(i=t[o]);if(a){e.n=12;break}if(i){e.n=7;break}return s=_.UUID(),e.n=6,this.createNewUser(t,l,u,s);case 6:f(s),e.n=11;break;case 7:if(_.isStrEmpty(i.accountId))return i.accountId=l,e.n=8,PlatformAPI.setStorage(this.tUsers,t,!0);e.n=9;break;case 8:f(i.clientUserId),e.n=11;break;case 9:return c=_.UUID(),e.n=10,this.createNewUser(t,l,"",c);case 10:f(c);case 11:e.n=16;break;case 12:if(i)e.n=15;else{if(_.isStrEmpty(a.distinctId))return a.distinctId=u,e.n=13,PlatformAPI.setStorage(this.tUsers,t,!0);e.n=14}break;case 13:e.n=15;break;case 14:return e.n=15,this.createNewUser(t,a.accountId,u,a.clientUserId);case 15:f(a.clientUserId);case 16:return e.a(2)}},e,this)})).bind(this))}},{key:"findUserByDistinctId",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].distinctId===t)return e[n]}},{key:"findUserByAccountId",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].accountId===t)return e[n]}},{key:"createNewUser",value:(a=_asyncToGenerator(_regenerator().m(function e(t,n,r,a){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return t.push({accountId:n,distinctId:r,clientUserId:a}),e.n=1,PlatformAPI.setStorage(this.tUsers,t,!0);case 1:return e.a(2)}},e,this)})),function(e,t,n,r){return a.apply(this,arguments)})}],[{key:"getInstance",value:function(e){return(t.instanceMaps=t.instanceMaps?t.instanceMaps:{})[e]||(t.instanceMaps[e]=new t(e)),t.instanceMaps[e]}}]);var a})(),TASK_INTERVAL_NORMAL=3e4,TASK_INTERVAL_DEBUG=5e3,TASK_CONTROL_DELAY=6e4,RemoteTimerTask=(()=>{function e(){_classCallCheck(this,e),this.normalTasks=[],this.debugTasks=[],this.callbackList=[],this.controlTimerList={},this.hasRegisterLifeCycle=!1}return _createClass(e,[{key:"addTimerTaskCallBack",value:function(e){this.callbackList.push(e)}},{key:"registerPageLifeCycle",value:function(){var e=this;this.hasRegisterLifeCycle||(PlatformAPI.initPageLifeCycle(function(){e.callTimerTask(3)}),this.hasRegisterLifeCycle=!0)}},{key:"addNewConfigs",value:function(e){"debug"===e.debugMode||"debugOnly"===e.debugMode?this.isTaskExist(this.debugTasks,e.appId,e.templateCode)||(this.debugTasks.push({appId:e.appId,tempCode:e.templateCode,isDebug:!0}),this.startDebugTimerTask()):this.isTaskExist(this.normalTasks,e.appId,e.templateCode)||(this.normalTasks.push({appId:e.appId,tempCode:e.templateCode,isDebug:!1}),this.startNormalTimerTask())}},{key:"startNormalTimerTask",value:function(){var e=this;clearTimeout(this.normalTimer),this.normalTimer=setTimeout(function(){e.callTimerTask(0),e.startNormalTimerTask()},TASK_INTERVAL_NORMAL)}},{key:"callTimerTask",value:function(e,t){for(var n=0;n<this.callbackList.length;n++)this.callbackList[n](e,t)}},{key:"startDebugTimerTask",value:function(){var e=this;clearTimeout(this.debuglTimer),this.debuglTimer=setTimeout(function(){e.callTimerTask(1),e.startDebugTimerTask()},TASK_INTERVAL_DEBUG)}},{key:"isTaskExist",value:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r].appId===t&&e[r].tempCode===n)return!0;return!1}},{key:"removeSystemErrorTask",value:function(t,n){this.debugTasks=this.debugTasks.filter(function(e){return e.appId!==t&&e.tempCode!==n}),this.normalTasks=this.normalTasks.filter(function(e){return e.appId!==t&&e.tempCode!==n}),0===this.debugTasks.length&&clearTimeout(this.debuglTimer),0===this.normalTasks.length&&clearTimeout(this.normalTimer)}},{key:"sendFetchControlDelayTask",value:function(e,t){var n=this;this.controlTimerList[e+t]=setTimeout(function(){n.callTimerTask(2,{appId:e,tempCode:t})},TASK_CONTROL_DELAY)}},{key:"removeDelayTemplateMessage",value:function(e,t){var n=this.controlTimerList[e+t];clearTimeout(n),this.controlTimerList[e+t]=void 0}},{key:"debugTaskToNormal",value:function(t,n){this.debugTasks=this.debugTasks.filter(function(e){return e.appId!==t&&e.tempCode!==n}),0===this.debugTasks.length&&clearTimeout(this.debuglTimer),this.normalTasks.push({appId:t,tempCode:n,isDebug:!1}),this.startNormalTimerTask()}}],[{key:"getInstance",value:function(){return e.instance=e.instance?e.instance:new e}}])})(),TDTemplateSetting=(()=>{return _createClass(function e(t,n){_classCallCheck(this,e),this.config=t,this.appSetting=n,this.customParams={},this.requestControlCount=0,this.lastFetchTime=0,this.mFetchListeners=[],this.defaultConfigKey=this.config.appId+"_"+this.config.templateCode+"_default_configs",this.fetchConfigKey=this.config.appId+"_"+this.config.templateCode+"_fetch_configs",this.tempInfoKey=this.config.appId+"_"+this.config.templateCode+"_infos",this.parseServerUrl(),this.mergeCustomFetchParams(this.config.customFetchParams)},[{key:"initTemplateAsync",value:(r=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.getStorage(this.tempInfoKey);case 1:return this.templateInfo=e.v,this.templateInfo||(this.templateInfo={}),e.n=2,PlatformAPI.getStorage(this.defaultConfigKey);case 2:return t=e.v,this.loadDefaultValues(t),e.n=3,PlatformAPI.getStorage(this.fetchConfigKey);case 3:t=e.v,this.loadFetchValues(t);case 4:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"loadDefaultValues",value:function(e){var t;e&&!this.defaultParams&&(t=e.config,e=e.type,t)&&e&&(_.parseJsonConfig(t,e),this.defaultParams={},_.extend(this.defaultParams,t)),this.defaultParams||(this.defaultParams={})}},{key:"loadFetchValues",value:function(e){var t,n;e&&(t=e.config,n=e.type,e.expirationPeriod&&(this.expirationTime=e.expirationPeriod),t)&&n&&(_.parseJsonConfig(t,n),this.applyConfigs||(this.applyConfigs={}),_.extend(this.applyConfigs,t)),this.applyConfigs||(this.applyConfigs={})}},{key:"parseServerUrl",value:function(){_.isDebug(this.config.debugMode)?this.serverUrl=this.config.serverUrl+"/v1/remote-config/debug":this.serverUrl=this.config.serverUrl+"/v1/remote-config/get"}},{key:"getTempCode",value:function(){return this.config.templateCode===Config.TEMPLATE_DEFAULT?"":this.config.templateCode}},{key:"getConfigTempCode",value:function(){return this.config.templateCode}},{key:"getServerUrl",value:function(){return this.serverUrl}},{key:"mergeCustomFetchParams",value:function(e){e&&(_.extend(this.customParams,e),logger.info1("custom fetch params result :",this.customParams))}},{key:"removeCustomParams",value:function(e){e&&(delete this.customParams[e],logger.info1("custom fetch params result :",this.customParams))}},{key:"mergeDefaultParams",value:function(e){var t;e&&(this.defaultParams||(t=PlatformAPI.getStorageSync(this.defaultConfigKey),this.loadDefaultValues(t)),_.extend(this.defaultParams,e),logger.info1("default params result :",this.defaultParams),t=_.parseConfigToJson(this.defaultParams),PlatformAPI.setStorage(this.defaultConfigKey,t))}},{key:"clearDefaultParams",value:function(){this.defaultParams={},logger.info("clear default params"),PlatformAPI.setStorage(this.defaultConfigKey,{})}},{key:"addConfigFetchListener",value:function(e){this.mFetchListeners.push(e)}},{key:"getCustomParams",value:function(){return this.customParams}},{key:"updateRemoteConfigs",value:(n=_asyncToGenerator(_regenerator().m(function e(t){var n,r,a,i,o,s,c,l;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:if(n=t.data){e.n=2;break}return e.a(2);case 2:if(this.updateLastFetchTime(),this.templateInfo.lastFetchStamp=t.timeStamp,PlatformAPI.setStorage(this.tempInfoKey,this.templateInfo),r=n.config,a=n.type,r&&a){e.n=3;break}return e.a(2);case 3:if(o=n.templateInfo,s=0,o&&(i=o.activationStrategy,s=o.expirationPeriod),(!s||s<=0)&&(s=Config.CONFIG_EXPIRED_TIME),o=AnalyticUtil.getCurrentTimeStamp()/1e3+s,s={config:r,type:a,expirationPeriod:o},PlatformAPI.setStorage(this.fetchConfigKey,s),i===Config.ACTIVATION_STRATEGY_IMMEDIATELY)for(this.expirationTime=o,this.activationSrategy=i,_.parseJsonConfig(r,a),this.applyConfigs||(this.applyConfigs={}),_.extend(this.applyConfigs,r),this.config.remoteconfigObserver&&this.config.remoteconfigObserver("onConfigApplySuccess",{appId:this.config.appId,templateCode:this.getConfigTempCode(),clientUserId:this.appSetting.getClientUserId()}),c={strategy_status_map:r.strategyStatusMap},l=0;l<this.mFetchListeners.length;l++)this.mFetchListeners[l](c);case 4:return e.a(2)}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"isStrategyNoExpired",value:function(){return this.activationSrategy===Config.ACTIVATION_STRATEGY_NEXT||!this.isExpired()}},{key:"isFetchExpired",value:function(){return 216e5<AnalyticUtil.getCurrentTimeStamp()-this.templateInfo.lastFetchStamp}},{key:"isExpired",value:function(){var e;return!!this.expirationTime&&((e=AnalyticUtil.getCurrentTimeStamp()/1e3>this.expirationTime)&&logger.info("remote config is expired"),e)}},{key:"loadParamsSync",value:function(){var e;this.defaultParams||(e=PlatformAPI.getStorageSync(this.defaultConfigKey),this.loadDefaultValues(e)),this.applyConfigs||(e=PlatformAPI.getStorageSync(this.fetchConfigKey),this.loadFetchValues(e))}},{key:"getAll",value:function(){this.loadParamsSync();var e={second:this.defaultParams};return this.isStrategyNoExpired()&&(e.first=this.applyConfigs),e}},{key:"uploadDebugEvent",value:function(e){!_.isDebug(this.config.debugMode)||this.hasSendDebugEvent||(this.hasSendDebugEvent=!0,AnalyticUtil.trackDebugFailEvent(this.config.appId,e))}},{key:"downGradeMode",value:function(){_.isDebug(this.config.debugMode)&&(this.config.debugMode="normal",this.parseServerUrl(),RemoteTimerTask.getInstance().debugTaskToNormal(this.config.appId,this.getConfigTempCode()))}},{key:"clearOldConfig",value:(e=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return this.applyConfigs={},e.n=1,PlatformAPI.setStorage(this.fetchConfigKey,{});case 1:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"addRequestCount",value:function(){_.isDebug(this.config.debugMode)||this.requestControlCount++}},{key:"updateLastFetchTime",value:function(){var e;_.isDebug(this.config.debugMode)||((e=AnalyticUtil.getCurrentDate().getMinutes())!==this.lastFetchTime&&(this.requestControlCount=1),this.lastFetchTime=e)}},{key:"isRequestControl",value:function(){var e;return!_.isDebug(this.config.debugMode)&&AnalyticUtil.getCurrentDate().getMinutes()===this.lastFetchTime&&((e=3<this.requestControlCount)&&(logger.info("fetch config too frequently , try again 60s later"),RemoteTimerTask.getInstance().sendFetchControlDelayTask(this.config.appId,this.config.templateCode)),e)}},{key:"notifyConfigChanged",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:n=(n=t)||this.appSetting.getClientUserId(),this.config.remoteconfigObserver&&this.config.remoteconfigObserver("onConfigChanged",{appId:this.config.appId,templateCode:this.getConfigTempCode(),clientUserId:n});case 1:return e.a(2)}},e,this)})),function(e){return t.apply(this,arguments)})}]);var t,e,n,r})(),TD_SYSTEM_CONFIG="td_system_config",RCC_CLIENT="rcc_client",SystemConfig=(()=>{function e(){_classCallCheck(this,e),this.loadFlags={},this.systemConfigs=[]}return _createClass(e,[{key:"loadLocalConfig",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var n,r,a;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(this.isFindAppIdConfig(t.appId))return e.a(2);e.n=1;break;case 1:return e.n=2,PlatformAPI.getStorage(TD_SYSTEM_CONFIG);case 2:if(n=e.v,!this.loadFlags[t.appId]){if(_.isArray(n))for(r=0;r<n.length;r++)(a=n[r]).appId===t.appId&&a.plat===RCC_CLIENT&&this.systemConfigs.push(a);this.loadFlags[t.appId]=!0}this.fetchRemoteSystemConfig(t.appId,t.serverUrl);case 3:return e.a(2)}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"fetchRemoteSystemConfig",value:(n=_asyncToGenerator(_regenerator().m(function e(n,t){var r,a,i=this;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.request({url:t+"/v1/remote-config/config?appid="+n,method:"GET"});case 1:if(r=e.v,r=r.data){e.n=2;break}return e.a(2);case 2:return logger.info1("Get system config success : ",r),e.n=3,PlatformAPI.getStorage(TD_SYSTEM_CONFIG);case 3:return a=e.v,_.isArray(a)||(a=[]),this.systemConfigs=this.systemConfigs.filter(function(e){return e.appId!==n}),a=a.filter(function(e){return e.appId!==n}),_.each(r,function(e,t){e={appId:n,plat:t,disabled:e.disabled,disabledVersionList:e.disabled_version_list};t===RCC_CLIENT&&i.systemConfigs.push(e),a.push(e)}),e.n=4,PlatformAPI.setStorage(TD_SYSTEM_CONFIG,a);case 4:return e.a(2)}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"isFindAppIdConfig",value:function(e){for(var t=0;t<this.systemConfigs.length;t++)if(this.systemConfigs[t].appId===e)return!0;return!1}},{key:"isRCCStop",value:function(e){if(!this.loadFlags[e]){var t=PlatformAPI.getStorageSync(TD_SYSTEM_CONFIG);if(_.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];r.appId===e&&r.plat===RCC_CLIENT&&this.systemConfigs.push(r)}0<this.systemConfigs.length&&(this.loadFlags[e]=!0)}for(var a=0;a<this.systemConfigs.length;a++){var i=this.systemConfigs[a];if(i.appId===e){if(i.disabled)return!0;for(var o=0;o<i.disabledVersionList.length;o++)if(i.disabledVersionList[a]===Config.LIB_VERSION)return!0}}return!1}}],[{key:"getInstance",value:function(){return e.instance=e.instance?e.instance:new e}}]);var n,t})(),TDAppSetting=(()=>{return _createClass(function e(t){_classCallCheck(this,e),this.appId=t.appId,this.templateSettings={},this.tUsers=this.appId+"_users",this.localUserKey=this.appId+"_localUser",this.addTemplateCode(t)},[{key:"initAsync",value:(a=_asyncToGenerator(_regenerator().m(function e(t){var n;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return ClientUserManager.getInstance(this.appId).loadClientUserId(),e.n=1,this.getClientUserIdAsync(this.getAccountId(),this.getDistinctId());case 1:if(this.clientUserId=e.v,n=this.getTemplateSetting(t))return e.n=2,n.initTemplateAsync();e.n=2;break;case 2:return e.a(2)}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"getTemplateSetting",value:function(e){if(!SystemConfig.getInstance().isRCCStop(this.appId))return _.isStrEmpty(e)?this.templateSettings[Config.TEMPLATE_DEFAULT]:this.templateSettings[e]}},{key:"addTemplateCode",value:function(e){var t;return!this.templateSettings[e.templateCode]&&(t=new TDTemplateSetting(e,this),this.templateSettings[e.templateCode]=t,!0)}},{key:"getAppId",value:function(){return this.appId}},{key:"getAccountId",value:function(){return AnalyticUtil.getAccountId(this.appId)}},{key:"getDistinctId",value:function(){return AnalyticUtil.getDistinctId(this.appId)}},{key:"getClientUserId",value:function(){return this.clientUserId}},{key:"getClientUserIdAsync",value:(r=_asyncToGenerator(_regenerator().m(function e(n,r){var a=this;return _regenerator().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(t,e){ClientUserManager.getInstance(a.appId).getClientUserId(n,r,function(e){t(e)})}))},e)})),function(e,t){return r.apply(this,arguments)})},{key:"updateAppConfigs",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var n,r,a,i;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:if(!((n=t.localUserId)&&0<n)){e.n=4;break}if(r=t.templateInfo){e.n=2;break}return e.a(2);case 2:return(!(a=r.userIdPeriod)||a<0)&&(a=Config.USER_ID_EXPIRED_TIME),a=AnalyticUtil.getCurrentTimeStamp()/1e3+a,e.n=3,PlatformAPI.getStorage(this.localUserKey);case 3:return i=e.v,i={localUserId:n,userIdExpiredTime:a,lastClientUserId:(i=i||{}).lastClientUserId,lastAccountId:i.lastAccountId},e.n=4,PlatformAPI.setStorage(this.localUserKey,i);case 4:return e.a(2)}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getLocalUserId",value:(e=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.getStorage(this.localUserKey);case 1:if(t=e.v){e.n=2;break}return e.a(2,"");case 2:if(-1===t.userIdExpiredTime)return e.a(2,"");e.n=3;break;case 3:if(AnalyticUtil.getCurrentTimeStamp()/1e3>t.userIdExpiredTime)return logger.info("local userId has expired and has been cleared"),e.a(2,"");e.n=4;break;case 4:return e.a(2,t.localUserId)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"doChangeAccount",value:(n=_asyncToGenerator(_regenerator().m(function e(t,n){var r,a,i,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.getStorage(this.localUserKey);case 1:return r=e.v,a=!0,(i=(r=r||{}).lastClientUserId)&&(a=!1),(i=i!==n)&&(r.lastClientUserId=n),o=r.lastAccountId,(o=o!==t)&&(r.lastAccountId=t),this.clientUserId=n,(i||o)&&(r.localUserId="",r.userIdExpiredTime=-1),e.n=2,PlatformAPI.setStorage(this.localUserKey,r);case 2:return e.a(2,{isFirstChange:a,isChangeAccount:i||o})}},e,this)})),function(e,t){return n.apply(this,arguments)})}]);var n,e,t,r,a})(),RemoteTaskQueue=(()=>{function e(){_classCallCheck(this,e),this.tasks=[],this.timeStamp=0}return _createClass(e,[{key:"addTask",value:function(e){var t=function(){return e.apply(this)}.bind(this);this.tasks.push(t),this.run()}},{key:"run",value:(t=_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(this.tasks.length<=0)return e.a(2);e.n=1;break;case 1:if(0===this.timeStamp||15e3<Date.now()-this.timeStamp)return this.timeStamp=Date.now(),t=this.tasks.shift(),e.n=2,t();e.n=3;break;case 2:this.timeStamp=0,this.run();case 3:return e.a(2)}},e,this)})),function(){return t.apply(this,arguments)})}],[{key:"getInstance",value:function(){return e.instance=e.instance?e.instance:new e}}]);var t})(),TDRemoteAPI=(()=>{function a(e){_classCallCheck(this,a),logger.enabled=e.enableLog,this.tempNetStatusList=[],this.accountTaskQueue=new AccountTaskQueue,this.mAppSetting=new TDAppSetting(e),RemoteTimerTask.getInstance().addTimerTaskCallBack(this.onTimerTaskCallBack.bind(this));var n=this;AnalyticUtil.registerAnalyticsObserver(function(e,t){n.doAnalyticsObserver(e,t)},e.appId),PlatformAPI.onNetworkStatusChange(function(e){n.doNetWorkChanged(e)})}return _createClass(a,[{key:"_init",value:(s=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:RemoteTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,SystemConfig.getInstance().loadLocalConfig(t);case 1:if(SystemConfig.getInstance().isRCCStop(t.appId))return e.a(2);e.n=2;break;case 2:if(a.systemInfos){e.n=4;break}return e.n=3,PlatformAPI.getSystemInfo();case 3:a.systemInfos=e.v;case 4:return e.n=5,this.mAppSetting.initAsync(t.templateCode);case 5:return RemoteTimerTask.getInstance().registerPageLifeCycle(t),RemoteTimerTask.getInstance().addNewConfigs(t),e.n=6,this.fetchWithTempCode(t.templateCode,3,!1);case 6:logger.info("TDRemoteConfig SDK initialize success with appId = "+t.appId+" , templateCode = "+t.templateCode+" , version = "+Config.LIB_VERSION);case 7:return e.a(2)}},e,this)})).bind(this));case 1:return e.a(2)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"setCustomFetchParams",value:function(e,t){var n=this.mAppSetting.getTemplateSetting(t);n&&RemoteTaskQueue.getInstance().addTask(function(){n.mergeCustomFetchParams(e)})}},{key:"removeCustomFetchParams",value:function(e,t){var n=this.mAppSetting.getTemplateSetting(t);n&&RemoteTaskQueue.getInstance().addTask(function(){n.removeCustomParams(e)})}},{key:"applyDefaultParams",value:function(e,t){t=this.mAppSetting.getTemplateSetting(t);t&&t.mergeDefaultParams(e)}},{key:"clearDefaultParams",value:function(e){e=this.mAppSetting.getTemplateSetting(e);e&&e.clearDefaultParams()}},{key:"applyDefaultParamsWithJsonFile",value:(r=_asyncToGenerator(_regenerator().m(function e(t,n){var r,a;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(r=this.mAppSetting.getTemplateSetting(n))return e.n=1,PlatformAPI.readFile(t);e.n=2;break;case 1:a=e.v,r.mergeDefaultParams(JSON.parse(a));case 2:return e.a(2)}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"addConfigFetchListener",value:function(e,t){_.isFunction(e)&&(t=this.mAppSetting.getTemplateSetting(t))&&t.addConfigFetchListener(e)}},{key:"getAll",value:function(e){e=this.mAppSetting.getTemplateSetting(e);if(e)return e.getAll()}},{key:"fetchWithTempCode",value:(o=_asyncToGenerator(_regenerator().m(function e(t,n,r,a,i){var o,s,c,l,u,f,h;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(o=this.mAppSetting.getTemplateSetting(t)){e.n=1;break}return e.a(2);case 1:if(r&&o.isRequestControl())return e.a(2);e.n=2;break;case 2:return l=a||this.mAppSetting.getAccountId(),u=i||this.mAppSetting.getDistinctId(),s=this,c=o,l=l,u=u,e.n=3,this.mAppSetting.getLocalUserId();case 3:return h=e.v,f=this.mAppSetting.getClientUserId(),h={accountId:l,distinctId:u,userId:h,clientUserId:f},f=s.obtainPostParams.call(s,c,h),e.n=4,this.fetchAsync(o,n,f,r);case 4:return e.a(2)}},e,this)})),function(e,t,n,r,a){return o.apply(this,arguments)})},{key:"fetchAsync",value:(i=_asyncToGenerator(_regenerator().m(function e(t,n,r,a){var i,o,s;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,PlatformAPI.isNetWorkConnect();case 1:if(e.v){e.n=2;break}return this.tempNetStatusList.push(t.getConfigTempCode()),e.a(2);case 2:if(t.addRequestCount(),a&&t.isRequestControl())return e.a(2);e.n=3;break;case 3:return o=AnalyticUtil.getCurrentTimeStamp(),i=_.sign(o,JSON.stringify(r)),logger.info1("fetch config start with appId = "+this.mAppSetting.getAppId()+" template = "+t.getConfigTempCode()+" params = ",r),e.n=4,PlatformAPI.request({url:t.getServerUrl(),header:{"Content-Type":"application/json",device_id:r.request_params["#device_id"],template_code:r.template_code,appid:this.mAppSetting.getAppId(),timestamp:o+"",sign:i},method:"POST",data:r});case 4:if(o=e.v,0===(s=_.parseResponse(o)).code)return logger.info1("get remote config success = ",s.data),e.n=5,this.mAppSetting.updateAppConfigs(s.data);e.n=7;break;case 5:return e.n=6,t.updateRemoteConfigs(s);case 6:e.n=12;break;case 7:logger.info("get remote config fail with code = "+s.code+" msg = "+s.msg),s.code<0&&-100<s.code?(t.uploadDebugEvent(s.code),RemoteTimerTask.getInstance().removeSystemErrorTask(this.mAppSetting.getAppId(),t.getConfigTempCode()),e.n=12):e.n=8;break;case 8:if(s.code<=-100&&-200<=s.code||-201===s.code){if(0<--n)return logger.info("retry fetch after 3 seconds"),e.n=9,this.setTimeoutAsync(3e3);e.n=10}else e.n=11;break;case 9:return e.n=10,this.fetchAsync(t,n,r,a);case 10:e.n=12;break;case 11:-202===s.code||-203===s.code?t.downGradeMode():500<=s.code&&s.code<600||s.code===Config.NETWORK_TIMEOUT||(s.code===Config.SIGN_ILLEGAL?AnalyticUtil.trackRiskEvent(this.mAppSetting.getAppId()):RemoteTimerTask.getInstance().removeSystemErrorTask(this.mAppSetting.getAppId(),t.getConfigTempCode()));case 12:return e.a(2)}},e,this)})),function(e,t,n,r){return i.apply(this,arguments)})},{key:"setTimeoutAsync",value:(t=_asyncToGenerator(_regenerator().m(function e(n){return _regenerator().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,t){setTimeout(function(){e(!0)},n)}))},e)})),function(e){return t.apply(this,arguments)})},{key:"obtainPostParams",value:function(e,t){var n={},r=(n.appid=this.mAppSetting.getAppId(),t.userId),r=(r&&(n.local_user_id=r),n.template_code=e.getTempCode(),n.last_fetch_time=e.templateInfo.lastFetchStamp?e.templateInfo.lastFetchStamp+"":"0",{"#account_id":t.accountId,"#distinct_id":t.distinctId,"#client_user_id":t.clientUserId,"#device_id":AnalyticUtil.getDeviceId()});return _.extend(r,a.systemInfos),_.extend(r,e.getCustomParams()),n.request_params=r,n}},{key:"onTimerTaskCallBack",value:function(f,h){RemoteTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){var t,n,r,a,i,o,s,c,l,u;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(0!==f&&1!==f){e.n=5;break}t=[],0===f?t=RemoteTimerTask.getInstance().normalTasks:1===f&&(t=RemoteTimerTask.getInstance().debugTasks),n=0;case 1:if(!(n<t.length)){e.n=4;break}if(i=t[n].appId,r=t[n].tempCode,i!==this.mAppSetting.getAppId()){e.n=3;break}if(a=this.mAppSetting.getTemplateSetting(r)){e.n=2;break}return e.a(3,3);case 2:if((i=a.isExpired())&&a.notifyConfigChanged(),i||t[n].isDebug)return e.n=3,this.fetchWithTempCode(r,1,!1);e.n=3;break;case 3:n++,e.n=1;break;case 4:e.n=11;break;case 5:if(2!==f)e.n=7;else{if(h.appId===this.mAppSetting.getAppId())return e.n=6,this.fetchWithTempCode(h.tempCode,1,!0);e.n=6}break;case 6:e.n=11;break;case 7:if(3!==f){e.n=11;break}o=RemoteTimerTask.getInstance().normalTasks,s=0;case 8:if(!(s<o.length)){e.n=11;break}if(c=o[s].appId,l=o[s].tempCode,c!==this.mAppSetting.getAppId()){e.n=10;break}if(u=this.mAppSetting.getTemplateSetting(l)){e.n=9;break}return e.a(3,10);case 9:if(u.isFetchExpired())return e.n=10,this.fetchWithTempCode(l,1,!0);e.n=10;break;case 10:s++,e.n=8;break;case 11:return e.a(2)}},e,this)})).bind(this))}},{key:"doAnalyticsObserver",value:(n=_asyncToGenerator(_regenerator().m(function e(t,i){var o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(SystemConfig.getInstance().isRCCStop(this.mAppSetting.getAppId()))return e.a(2);e.n=1;break;case 1:if("onAccountChanged"===t)return e.n=2,this.mAppSetting.getClientUserIdAsync(i.accountId,i.distinctId);e.n=3;break;case 2:o=e.v,RemoteTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){var r,a=this;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.mAppSetting.doChangeAccount(i.accountId,o);case 1:if((r=e.v).isChangeAccount){e.n=2;break}return e.a(2);case 2:logger.info("change account success with accountId = "+i.accountId+" , distinctId = "+i.distinctId),_.each(this.mAppSetting.templateSettings,(()=>{var n=_asyncToGenerator(_regenerator().m(function e(t,n){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(r.isFirstChange){e.n=1;break}return e.n=1,t.clearOldConfig();case 1:return t.notifyConfigChanged(o),RemoteTimerTask.getInstance().removeDelayTemplateMessage(a.mAppSetting.getAppId(),t.getConfigTempCode()),e.n=2,a.fetchWithTempCode(n,1,!0,i.accountId,i.distinctId);case 2:return e.a(2)}},e)}));return function(e,t){return n.apply(this,arguments)}})());case 3:return e.a(2)}},e,this)})).bind(this));case 3:return e.a(2)}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"doNetWorkChanged",value:function(e){e&&e.isConnected&&RemoteTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){var t;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:t=0;case 1:if(t<this.tempNetStatusList.length)return e.n=2,this.fetchWithTempCode(self.tempNetStatusList[t],1,!1);e.n=3;break;case 2:t++,e.n=1;break;case 3:this.tempNetStatusList=[];case 4:return e.a(2)}},e,this)})).bind(this))}}],[{key:"init",value:function(e){var t;(e=_.checkSettings(e))&&((t=a._shareInstance(e.appId))?t.mAppSetting.addTemplateCode(e)&&t._init(e):(t=new a(e),a.sInstanceMap[e.appId]=t,a._defaultInstance||(a._defaultInstance=t),t._init(e)))}},{key:"_shareInstance",value:function(e){return void 0!==(a.sInstanceMap=a.sInstanceMap?a.sInstanceMap:{})[e]?a.sInstanceMap[e]:void 0!==a._defaultInstance?a._defaultInstance:void 0}}]);var n,t,i,o,r,s})(),TDRemoteConfig=(()=>_createClass(function e(){_classCallCheck(this,e)},null,[{key:"init",value:function(e){TDRemoteAPI.init(e)}},{key:"setDefaultValues",value:function(e,t){t=TDRemoteAPI._shareInstance(t);t&&t.applyDefaultParams(e)}},{key:"setDefaultValuesWithJsonFile",value:function(e,t){t=TDRemoteAPI._shareInstance(t);t&&t.applyDefaultParamsWithJsonFile(e)}},{key:"clearDefaultValues",value:function(e){e=TDRemoteAPI._shareInstance(e);e&&e.clearDefaultParams()}},{key:"setCustomFetchParams",value:function(e,t,n){t=TDRemoteAPI._shareInstance(t);t&&t.setCustomFetchParams(e,n)}},{key:"removeCustomFetchParam",value:function(e,t,n){t=TDRemoteAPI._shareInstance(t);t&&t.removeCustomFetchParams(e,n)}},{key:"fetch",value:function(e,t){var n=TDRemoteAPI._shareInstance(e);n&&RemoteTaskQueue.getInstance().addTask(_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:n.fetchWithTempCode(t,1,!0);case 1:return e.a(2)}},e)})))}},{key:"setLogPrintListener",value:function(e){logger.listener=e}},{key:"addConfigFetchListener",value:function(e){var t=TDRemoteAPI._shareInstance();if(t)return t.addConfigFetchListener(e)}},{key:"getData",value:function(e,t){var n,e=TDRemoteAPI._shareInstance(e);return e&&(n=e.getAll(t)),new TDObject(n)}}]))();PlatformAPI.setGlobalData(TDRemoteConfig),module.exports=TDRemoteConfig;