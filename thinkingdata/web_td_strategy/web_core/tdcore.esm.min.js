function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==typeof i?i:i+""}var PlatformProxy=function(){function PlatformProxy(api){_classCallCheck(this,PlatformProxy);this.api=api}return _createClass(PlatformProxy,[{key:"getAnalyticGlobalData",value:function getAnalyticGlobalData(){return this.api.tdanalytics2024}},{key:"getConfigGlobalData",value:function getConfigGlobalData(){return this.api.tdremoteconfig2024}},{key:"getStrategyGlobalData",value:function getStrategyGlobalData(){return this.api.tdstrategy2024}}],[{key:"createInstance",value:function createInstance(){return new PlatformProxy(window)}}])}();var PlatformAPI=function(){function PlatformAPI(){_classCallCheck(this,PlatformAPI)}return _createClass(PlatformAPI,null,[{key:"_getCurrentPlatform",value:function _getCurrentPlatform(){return this.currentPlatform||(this.currentPlatform=PlatformProxy.createInstance())}},{key:"getAnalyticGlobalData",value:function getAnalyticGlobalData(){return this._getCurrentPlatform().getAnalyticGlobalData()}},{key:"getConfigGlobalData",value:function getConfigGlobalData(){return this._getCurrentPlatform().getConfigGlobalData()}},{key:"getStrategyGlobalData",value:function getStrategyGlobalData(){return this._getCurrentPlatform().getStrategyGlobalData()}}])}();var _={};var ObjProto=Object.prototype,nativeToString=ObjProto.toString,nativeIsArray=Array.isArray;_.isArray=nativeIsArray||function(obj){return nativeToString.call(obj)==="[object Array]"};var STRATEGY_TEMPLATE_CODE="td_strategy";var TDApp=function(){function TDApp(){_classCallCheck(this,TDApp)}return _createClass(TDApp,null,[{key:"init",value:function init(config){if(!config)return;var TDAnalytics=PlatformAPI.getAnalyticGlobalData();var TDRemoteConfig=PlatformAPI.getConfigGlobalData();var TDStrategy=PlatformAPI.getStrategyGlobalData();if(!TDAnalytics)return;TDAnalytics.init(config);if(!TDRemoteConfig)return;var templates=config.templates;if(_.isArray(templates)){for(var i=0;i<templates.length;i++){var item=templates[i];if(!item)continue;var mode="none";if(item.templateCode===STRATEGY_TEMPLATE_CODE){mode=item.debugMode?item.debugMode:item.mode}TDRemoteConfig.init({appId:config.appId,serverUrl:config.serverUrl,enableLog:config.enableLog,templateCode:item.templateCode,customFetchParams:item.customFetchParams,debugMode:mode})}}else{TDRemoteConfig.init({appId:config.appId,serverUrl:config.serverUrl,templateCode:"",enableLog:config.enableLog})}if(!TDStrategy)return;TDStrategy.init({appId:config.appId,serverUrl:config.serverUrl,enableLog:config.enableLog,debugMode:config.debugMode?config.debugMode:config.mode,triggerListener:config.triggerListener})}}])}();export default TDApp;